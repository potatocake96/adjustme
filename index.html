<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>adjustME — Learning adjustments made simple</title>
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml"/>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.3/dist/umd/supabase.min.js"></script>
<script>window.__ADJ_TOKENS__ = window.__ADJ_TOKENS__ || [{"text": "Sentence starters", "cat": "literacy"}, {"text": "Sentence frames", "cat": "literacy"}, {"text": "Word bank", "cat": "literacy"}, {"text": "Graphic organiser", "cat": "literacy"}, {"text": "Advance organiser", "cat": "literacy"}, {"text": "Anchor chart", "cat": "literacy"}, {"text": "Pre‑teach vocab", "cat": "literacy"}, {"text": "Read‑aloud support", "cat": "literacy"}, {"text": "Enlarged print", "cat": "literacy"}, {"text": "Coloured overlay", "cat": "literacy"}, {"text": "Dyslexia‑friendly font", "cat": "literacy"}, {"text": "Captions on video", "cat": "literacy"}, {"text": "Subtitles", "cat": "literacy"}, {"text": "Reading guide", "cat": "literacy"}, {"text": "Calm corner", "cat": "behaviour"}, {"text": "1‑to‑1 check‑in", "cat": "behaviour"}, {"text": "Teacher proximity", "cat": "behaviour"}, {"text": "Reduced distractions", "cat": "behaviour"}, {"text": "Preferential seating", "cat": "behaviour"}, {"text": "Noise‑cancelling", "cat": "behaviour"}, {"text": "Movement break", "cat": "behaviour"}, {"text": "Fidget tools", "cat": "behaviour"}, {"text": "Low‑stim space", "cat": "behaviour"}, {"text": "Goal check‑in", "cat": "behaviour"}, {"text": "Assistive tech", "cat": "accessibility"}, {"text": "Speech‑to‑text", "cat": "accessibility"}, {"text": "Text‑to‑speech", "cat": "accessibility"}, {"text": "Interpreter meeting", "cat": "accessibility"}, {"text": "EAL scaffold", "cat": "accessibility"}, {"text": "Parent comms note", "cat": "accessibility"}, {"text": "Separate room", "cat": "accessibility"}, {"text": "Reader", "cat": "accessibility"}, {"text": "Scribe", "cat": "accessibility"}, {"text": "Extra time", "cat": "timing"}, {"text": "Processing time", "cat": "timing"}, {"text": "Visual timer", "cat": "timing"}, {"text": "Pomodoro", "cat": "timing"}, {"text": "Task timer", "cat": "timing"}, {"text": "Chunked steps", "cat": "timing"}, {"text": "Chunk‑and‑check", "cat": "timing"}, {"text": "Visual schedule", "cat": "timing"}, {"text": "Visual timetable", "cat": "timing"}, {"text": "Think‑pair‑share", "cat": "timing"}, {"text": "Exit ticket", "cat": "timing"}, {"text": "Learning intention visible", "cat": "timing"}, {"text": "Success criteria", "cat": "timing"}, {"text": "Tiered criteria", "cat": "timing"}, {"text": "Choice board", "cat": "timing"}, {"text": "Choice of response", "cat": "timing"}, {"text": "Differentiated task", "cat": "timing"}, {"text": "Modified assessment", "cat": "timing"}, {"text": "Reduced homework", "cat": "timing"}, {"text": "Alternative seating", "cat": "timing"}, {"text": "Model answer", "cat": "timing"}, {"text": "New template 🤯", "cat": "satire"}, {"text": "Urgent email 📧", "cat": "satire"}, {"text": "Meeting about meetings 🙃", "cat": "satire"}, {"text": "Mandatory PD at 4pm ☕", "cat": "satire"}, {"text": "Another new rubric 📊", "cat": "satire"}, {"text": "Surprise audit 📋", "cat": "satire"}, {"text": "47th spreadsheet 🔢", "cat": "satire"}, {"text": "Password reset again 🔐", "cat": "satire"}, {"text": "Printer jam 🖨️", "cat": "satire"}, {"text": "Stakeholder alignment 🤝", "cat": "satire"}, {"text": "“Quick 5‑min chat” ⏱️", "cat": "satire"}, {"text": "Scope creep 🧱", "cat": "satire"}, {"text": "Friday 4:59 request 🕔", "cat": "satire"}, {"text": "Dashboard nobody reads 📈", "cat": "satire"}, {"text": "Compliance vortex 🌀", "cat": "satire"}, {"text": "Rebrand the matrix™", "cat": "satire"}];
const tk = window.__ADJ_TOKENS__ || [];


// rain generator removed (replaced)
// --- Adjustment Rain (robust + categories) ---
document.addEventListener('DOMContentLoaded', function(){
  const rain = document.querySelector('.rain');
  if (!rain) return;
  const emojis = ['🧠','✍️','⏳','📋','🎧','✅','🧭','📚','🧩','🪄'];
  function rand(min,max){ return Math.random()*(max-min)+min; }
  const count = window.matchMedia('(max-width: 640px)').matches ? 14 : 26;

  for (let i=0;i<count;i++){
    const d = document.createElement('div');
    d.className = 'drop';
    const pick = tk[Math.floor(Math.random()*tk.length)];
    const useEmoji = Math.random() < 0.12 && pick.cat !== 'satire';
    const text = useEmoji ? emojis[Math.floor(Math.random()*emojis.length)] : pick.text;
    const cls = 'tag cat-' + pick.cat;
    d.innerHTML = `<span class="${cls}">${useEmoji ? `<span class="em">${text}</span>` : text}</span>`;
    d.style.left = rand(2, 96) + '%';
    const dur = rand(7, 11);
    const delay = rand(-10, 0);
    const scale = rand(0.9, 1.15);
    const sway = rand(8, 22); // px sideways sway
    d.style.animationDuration = dur + 's';
    d.style.animationDelay = delay + 's';
    d.style.setProperty('--sway', sway + 'px');
    d.style.transform = `translateY(-10%) scale(${scale})`;
    rain.appendChild(d);
  }
});



</script>
  <style>
    :root{
      --bg:#F7FAF9; --surface:#FFFFFF; --ink:#0B1220; --ink-2:#475569; --muted:#667085; --border:#E6E8EC;
      --brand:#10B981; --brand-2:#2DD4BF; --brand-3:#ECFDF5;
      --focus:0 0 0 3px rgba(16,185,129,.35);
      --max:1200px; --radius:16px; --radius-lg:22px; --radius-xl:28px;
      --shadow-sm:0 8px 18px rgba(2,6,23,.06); --shadow:0 24px 50px rgba(2,6,23,.12);
      --dur-fast:.16s; --dur:.28s; --dur-slow:.55s; --ease:cubic-bezier(.22,.61,.36,1)
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;background:var(--bg);color:var(--ink);
      font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","SF Pro Display",Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      -webkit-font-smoothing:antialiased;line-height:1.6;opacity:0;transform:translateY(4px)
    }
    body.ready{opacity:1;transform:none;transition:opacity var(--dur-slow) var(--ease),transform var(--dur-slow) var(--ease)}
    a{color:inherit;text-decoration:none}
    .wrap{width:100%;max-width:var(--max);margin:0 auto;padding:0 20px}
    /* Header */
    header{position:sticky;top:0;z-index:40;background:rgba(255,255,255,.85);backdrop-filter:saturate(180%) blur(8px);border-bottom:1px solid var(--border)}
    .head{display:flex;justify-content:space-between;align-items:center;min-height:62px}
    .brand{font-weight:900;letter-spacing:-.015em;display:flex;align-items:center;gap:10px}
    .brand .word{font-size:18px}.brand .me{color:var(--brand)}
    .nav{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .chip{background:#fff;border:1px solid var(--border);border-radius:999px;padding:10px 14px;font-weight:800;min-height:40px;cursor:pointer;white-space:nowrap;transition:transform var(--dur-fast) var(--ease),box-shadow var(--dur) var(--ease),background var(--dur) var(--ease)}
    .chip:hover{transform:translateY(-1px)}
    /* Buttons */
    button{font:inherit;border:1px solid var(--border);border-radius:12px;background:#fff;color:var(--ink);min-height:44px;padding:10px 16px;cursor:pointer;font-weight:700;transition:transform var(--dur-fast) var(--ease),box-shadow var(--dur) var(--ease),background var(--dur) var(--ease)}
    button:focus{outline:none;box-shadow:var(--focus)}
    .cta{display:inline-flex;align-items:center;gap:10px;background:linear-gradient(180deg,var(--brand),var(--brand-2));color:#073328;padding:12px 18px;border-radius:999px;font-weight:900;min-height:44px;transition:transform var(--dur-fast) var(--ease)}
    .cta:hover{transform:translateY(-2px)}
    .cta.secondary{background:#fff;color:#0B1220;border:1px solid var(--border)}
    /* Adjustment Rain Hero */
    .hero{position:relative;overflow:hidden;background:linear-gradient(180deg,#FFFFFF 0%, #F4FFFB 100%)}
    .hero-inner{position:relative;min-height: 80vh;display:grid;place-items:center;padding:88px 0 120px;text-align:center;z-index:2}
    .hero h1{margin:0 0 14px;font-size:clamp(34px,6vw,56px);letter-spacing:-.02em;animation:rise .9s var(--ease) both}
    .hero p{margin:0 auto;max-width:760px;font-size:18px;color:var(--ink-2);animation:rise 1.1s var(--ease) both .12s}
    .hero .actions{display:flex;gap:12px;justify-content:center;margin-top:18px;animation:rise 1.2s var(--ease) both .2s}

    /* Falling "adjustment" tags */
    .rain{ opacity: .5; }
    .drop{position:absolute; top:-60px; will-change:transform, top; animation:fallY linear infinite;}
    .tag{display:inline-flex;align-items:center;gap:6px;padding:8px 12px;border-radius:999px;border:1px solid rgba(16,185,129,.35);background:rgba(16,185,129,.22);color:#0b3b2f;font-weight:800;font-size:14px;box-shadow:0 8px 16px rgba(2,6,23,.10)}
    .tag .em{font-size:14px}
    100%{top:calc(100% + 60px)}}100%{transform:translateY(110vh) rotate(6deg)}}

    /* Reduce motion */
    @media (prefers-reduced-motion: reduce){
      .drop{animation:none !important;}
    }

    /* Sections */
    
    
    
    .section{padding:48px 0}
    .section-title{margin:0 0 12px;font-size:24px;letter-spacing:-.01em;text-align:center}
    .sub{margin:0 auto 12px;max-width:740px;color:var(--ink-2);text-align:center}
    /* Cards/grid */
    .grid{display:grid;gap:18px}
    .cards3{grid-template-columns:1fr}
    @media(min-width:900px){.cards3{grid-template-columns:repeat(3,1fr)}}
    .card{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);box-shadow:var(--shadow-sm);padding:18px;transition:transform .3s var(--ease), box-shadow .3s var(--ease)}
    .card:hover{transform:translateY(-4px);box-shadow:var(--shadow)}
    .card h3{margin:0 0 8px;font-size:18px}
    .card p{margin:0;color:var(--ink-2)}
    /* Secure section */
    .secure{max-width:1100px;margin:0 auto}
    .secure .cards2{grid-template-columns:1fr}
    @media(min-width:900px){.secure .cards2{grid-template-columns:1fr 1fr}}
    /* Footer */
    footer{border-top:1px solid var(--border);background:#fff}
    footer .foot{display:flex;justify-content:space-between;align-items:center;gap:16px;padding:18px 0;color:#6B7280;font-size:14px;flex-wrap:wrap}
    /* Modal (redesigned) */
    .modal-backdrop{position:fixed;inset:0;background:rgba(2,6,23,.45);display:none;align-items:center;justify-content:center;z-index:60;backdrop-filter:blur(4px);opacity:0;transition:opacity var(--dur) var(--ease)}
    .modal-backdrop.show{display:flex;opacity:1}
    .modal{width:min(860px,92vw);background:#fff;border:1px solid var(--border);border-radius:22px;box-shadow:var(--shadow);transform:translateY(16px) scale(.985);opacity:.98;transition:transform var(--dur) var(--ease),opacity var(--dur) var(--ease);max-height:90vh;overflow:auto}
    .modal.show{transform:translateY(0) scale(1);opacity:1}
    .modal-header{padding:18px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
    .modal-title{font-weight:900;letter-spacing:.01em;font-size:18px}
    .modal-body{padding:20px}
    .modal-actions{padding:16px 20px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:8px;flex-wrap:wrap}
    .modal .grid-inputs{display:grid;gap:14px}
    .modal .grid-inputs.two{grid-template-columns:1fr}
    @media(min-width:720px){.modal .grid-inputs.two{grid-template-columns:1fr 1fr}}
    label.small{display:block;margin:0 0 6px;color:#3f4a5a;font-weight:600;font-size:13px;letter-spacing:.02em}
    input,textarea{font:inherit;border:1px solid var(--border);border-radius:12px;background:#fff;color:var(--ink);width:100%}
    input{height:44px;padding:0 14px} textarea{padding:12px 14px;min-height:120px}
    input::placeholder,textarea::placeholder{color:#94A3B8}
    input:focus,textarea:focus{outline:none;box-shadow:var(--focus)}
    /* Demo helper note */
    .note{font-size:13px;color:#6B7280;margin-top:6px}
    /* Reveal on scroll */
    .reveal{opacity:0;transform:translateY(16px);transition:opacity .6s var(--ease),transform .6s var(--ease)}
    .reveal.show{opacity:1;transform:none}
    /* Mobile small tweaks */
    @media(max-width:640px){
      .chip{padding:8px 10px;font-size:14px;min-height:34px}
      button{font-size:16px}
    }
    /* Motion base */
    @keyframes rise{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}
    @media(prefers-reduced-motion:reduce){*{animation-duration:.001ms!important;animation-iteration-count:1!important;transition-duration:.001ms!important;scroll-behavior:auto!important}}
  
    .modal.modal-sm{width:min(560px,92vw)}


/* Subtle overlay between rain and content */
.hero::before{content:"";position:absolute;inset:0;background:linear-gradient(180deg, rgba(255,255,255,.88) 0%, rgba(255,255,255,.60) 45%, rgba(255,255,255,.88) 100%);z-index:1;pointer-events:none;}


/* Make rain itself more subtle */
.rain{ opacity: .5; }
.tag{
  border:1px solid rgba(16,185,129,.28) !important;
  background: rgba(16,185,129,.12) !important;
  color:#0b3b2f !important;
  font-weight:700 !important;
}


/* Stronger veil + text shadow for readability */
.hero::before{content:"";position:absolute;inset:0;background:linear-gradient(180deg, rgba(255,255,255,.88) 0%, rgba(255,255,255,.60) 45%, rgba(255,255,255,.88) 100%);z-index:1;pointer-events:none;}
.hero h1{ text-wrap: balance; text-shadow: 0 1px 0 rgba(255,255,255,.6), 0 8px 26px rgba(255,255,255,.55); }
.hero p{ text-shadow: 0 1px 0 rgba(255,255,255,.5), 0 4px 16px rgba(255,255,255,.45); }


/* Sideways sway using CSS variable per drop */
@keyframes fallY { 0% { top:-60px; transform: translateX(0); } 100% { top: calc(100% + 60px); transform: translateX(var(--sway)); } }

/* Category color-coding */
.tag.cat-literacy     { background: rgba(59,130,246,.14) !important; border-color: rgba(59,130,246,.30) !important; color:#0b2a66 !important; }
.tag.cat-behaviour    { background: rgba(16,185,129,.14) !important; border-color: rgba(16,185,129,.30) !important; color:#064e3b !important; }
.tag.cat-accessibility { background: rgba(245,158,11,.14) !important; border-color: rgba(245,158,11,.30) !important; color:#7c3e00 !important; }
.tag.cat-timing       { background: rgba(99,102,241,.14) !important; border-color: rgba(99,102,241,.30) !important; color:#1e1b4b !important; }
.tag.cat-satire       { background: rgba(244,63,94,.14) !important; border-color: rgba(244,63,94,.30) !important; color:#7f1d1d !important; }

</style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="wrap head">
      <div class="brand"><span class="word">adjust<span class="me">ME</span></span></div>
      <nav class="nav">
        <button id="try" class="chip">Try a quick demo</button>
        <a class="chip" href="login.html">Sign in</a>
      </nav>
    </div>
  </header>

  <!-- Hero with animated waves -->
  <section class="hero">
    <div class="wrap hero-inner"><div>
        <h1>Adjustments, ready for your report.</h1>
        <p>Turn quick notes into clear, school‑ready adjustments. Keep student profiles tidy. Generate and copy paragraphs with one click—no clutter saved.</p>
        <div class="actions">
          <a class="cta" href="login.html">Start now</a>
          <a class="cta secondary" href="#how">How it works</a>
        </div>
      </div>
    </div>
    <div class="rain" aria-hidden="true"></div>
  </section>

  <!-- How it works -->
  <section id="how" class="section">
    <div class="wrap">
      <h2 class="section-title reveal">How it works</h2>
      <p class="sub reveal">Three simple steps. No setup. Nothing saved that you don’t intend to.</p>
      <div class="grid cards3">
        <div class="card reveal">
          <h3>1. Add students</h3>
          <p>Enter a student name and capture barriers/adjustments as short, scannable bullets.</p>
          <ul style="margin:10px 0 0 18px; color: var(--ink-2)">
            <li>Paste from emails or notes — we’ll tidy the formatting.</li>
            <li>Use <em>-</em> or <em>*</em> and new lines; no special template required.</li>
            <li>Nothing sensitive: only name, barriers, and adjustments are stored.</li>
          </ul>
        </div>
        <div class="card reveal">
          <h3>2. Create</h3>
          <p>Pick the student and a date to generate clear, classroom‑ready items.</p>
          <ul style="margin:10px 0 0 18px; color: var(--ink-2)">
            <li>Server‑side AI (Supabase Edge Functions) — private and fast.</li>
            <li>Language tuned for Australian school reports.</li>
            <li>One‑click “select all” or pick just the items you need.</li>
          </ul>
        </div>
        <div class="card reveal">
          <h3>3. Paragraph</h3>
          <p>Open the popout to collate selected items into a neat paragraph for reports.</p>
          <div class="stack" style="margin-top:10px"><button id="seeExample" class="chip">See an example</button></div>
          <ul style="margin:10px 0 0 18px; color: var(--ink-2)">
            <li>Copy buttons beside each item and for the whole paragraph.</li>
            <li>Wording aims for clarity, proportionality, and inclusive tone.</li>
            <li>No paragraphs are saved — you control where it goes.</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Security & Modern -->
  <section id="secure" class="section">
    <div class="wrap secure">
      <h2 class="section-title reveal">Why adjustME is secure &amp; modern</h2>
      <p class="sub reveal">Built for Australian schools: practical privacy, strong authentication, and modern serverless AI.</p>
      <div class="grid cards2">
        <div class="card reveal">
          <h3>Cybersecure by design</h3>
          <p>Compliant with Australian cybersecurity standards and best practices. Only student profiles (name, barriers, adjustments) are stored—no sensitive data, no reports saved. Supabase Auth provides secure sign‑in; secrets remain server‑side.</p>
        </div>
        <div class="card reveal">
          <h3>Cutting-edge technology</h3>
          <p>Supabase Edge Functions run AI securely on the server—no browser tokens, minimal attack surface. Fast, serverless, and always up to date.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA -->
  <section class="section" style="padding-top:0">
    <div class="wrap">
      <div class="card reveal" style="text-align:center;padding:28px">
        <h3 style="margin:0 0 6px;font-size:20px">Get started in minutes</h3>
        <p style="margin:0 0 12px;color:var(--ink-2)">Log in, add a student, generate, copy. That’s it.</p>
        <div style="display:flex;gap:10px;justify-content:center;margin-top:8px">
          <a class="cta" href="login.html">Start now</a>
          <button id="try2" class="chip">Try a quick demo</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="wrap foot">
      <div>© Simon Dass</div>
      <div class="small">Private by design — only student profiles are saved.</div>
    </div>
  </footer>

  <!-- Demo Modal (redesigned) -->
  <div id="demoBack" class="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="demoTitle">
    <div class="modal">
      <div class="modal-header">
        <div id="demoTitle" class="modal-title">Try adjustME now</div>
        <button id="d_close" class="chip" style="min-height:32px;padding:6px 10px">Close</button>
      </div>
      <div class="modal-body">
        <div class="grid-inputs two">
          <div>
            <label class="small">Teacher</label>
            <input id="d_teacher" placeholder="e.g., Ms Taylor"/>
            <div class="note">Use a pseudonym if you prefer.</div>
          </div>
          <div>
            <label class="small">Student</label>
            <input id="d_student" placeholder="e.g., Craig"/>
          </div>
        </div>
        <div class="grid-inputs two" style="margin-top:12px">
          <div>
            <label class="small">Barriers (one per line)</label>
            <textarea id="d_barriers" placeholder="- attention
- anxiety"></textarea>
          </div>
          <div>
            <label class="small">Adjustments (one per line)</label>
            <textarea id="d_adjust" placeholder="- one-to-one support
- calm corner"></textarea>
          </div>
        </div>
        <div id="d_msg" class="note" aria-live="polite"></div>
        
        
        <div id="d_results" style="margin-top:14px; display:none">
          
          <h4 style="margin:0 0 8px">Collated paragraph</h4>
          <div id="d_para" class="pretty" style="margin:0 0 8px"></div>
          <div style="display:flex;justify-content:flex-end;gap:8px">
            <button id="d_copy_para" class="btn primary">Copy paragraph</button>
          </div>
        </div>
        
      </div>
      <div class="modal-actions">
        <button id="d_go" class="cta">Generate sample paragraph</button>
      </div>
    </div>
  </div>

  <script>
// Page ready & reveal
    document.addEventListener('DOMContentLoaded', function(){
      document.body.classList.add('ready');
      const els = document.querySelectorAll('.reveal');
      const io = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{ if (e.isIntersecting) { e.target.classList.add('show'); io.unobserve(e.target); } });
      }, {threshold:.15});
      els.forEach(el=>io.observe(el));
    });

    // Supabase client for demo
    const supabaseUrl = "https://fskoqwpzomolfywimrjj.supabase.co";
    const supabaseAnon = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZza29xd3B6b21vbGZ5d2ltcmpqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc0MDg2NjEsImV4cCI6MjA3Mjk4NDY2MX0.KH9aTJgF9F2BGokJAjOtVkrjybTpVamvXGu7aVxGou8";
    var sb = window.supabase.createClient(supabaseUrl, supabaseAnon);

    // Modal handlers
    const back = document.getElementById('demoBack');
    function openDemo(){ if (back){ back.classList.add('show'); const m = document.querySelector('#demoBack .modal'); if (m) m.classList.add('show'); } }
    function closeDemo(){ if (back){ back.classList.remove('show'); const m = document.querySelector('#demoBack .modal'); if (m) m.classList.remove('show'); } }
    const bind = (id, handler) => { const el = document.getElementById(id); if (el) el.onclick = handler; };
    bind('try', openDemo);
    bind('try2', openDemo);
    bind('d_close', closeDemo);
    back && back.addEventListener('click', function(e){ if (e.target === back) closeDemo(); });

    // Demo generate
const dGoBtn = document.getElementById('d_go');
if (dGoBtn) dGoBtn.onclick = async function(){
  const msg = document.getElementById('d_msg');
  const teacher = (document.getElementById('d_teacher')?.value || 'Teacher').trim();
  const student = (document.getElementById('d_student')?.value || 'Student').trim();
  const barriers = (document.getElementById('d_barriers')?.value || '').split('\n').map(x=>x.replace(/^[-*]\s?/, '').trim()).filter(Boolean);
  const adjustments = (document.getElementById('d_adjust')?.value || '').split('\n').map(x=>x.replace(/^[-*]\s?/, '').trim()).filter(Boolean);
  if (msg) msg.textContent = 'Thinking…';
  try{
    const gen = await sb.functions.invoke('ai', { body: { op:'generate', student: { name: student, barriers, adjustments }, teacher, date_ddmmyyyy: new Date().toLocaleDateString('en-GB') } });
    if (gen.error){ if (msg) msg.textContent = gen.error.message || 'Server error.'; return; }
    const items = (gen.data && Array.isArray(gen.data.items)) ? gen.data.items : [];
    const descs = items.map(x=>x.description);
    const col = await sb.functions.invoke('ai', { body: { op:'collate', descriptions: descs } });
    const text = (col.data && col.data.text) ? col.data.text : '';
    const para = document.getElementById('d_para');
    const wrap = document.getElementById('d_results') || document.querySelector('#demoBack .modal-body');
    if (para) para.textContent = text;
    if (wrap && wrap.style) wrap.style.display = 'block';
    if (msg) msg.textContent = '';
    const dCopyPara = document.getElementById('d_copy_para');
    if (dCopyPara){
      dCopyPara.onclick = async function(){
        try{ await navigator.clipboard.writeText(text || para?.textContent || ''); const old = this.textContent; this.textContent='Copied!'; setTimeout(()=>this.textContent=old, 1100);}catch(e){ alert('Copy failed'); }
      };
    }
  }catch(e){ if (msg) msg.textContent = (e && e.message) ? e.message : String(e); }
};
// Example modal handlers
const exBack = document.getElementById('exampleBack');
const seeExampleBtn = document.getElementById('seeExample');
if (seeExampleBtn && exBack){
  seeExampleBtn.onclick = function(){ exBack.classList.add('show'); const m = document.querySelector('#exampleBack .modal'); if (m) m.classList.add('show'); };
}
const exClose = document.getElementById('ex_close');
if (exClose && exBack){
  exClose.onclick = function(){ exBack.classList.remove('show'); const m = document.querySelector('#exampleBack .modal'); if (m) m.classList.remove('show'); };
}
exBack && exBack.addEventListener('click', function(e){ if (e.target === exBack){ exBack.classList.remove('show'); const m = document.querySelector('#exampleBack .modal'); if (m) m.classList.remove('show'); } });

// Copy example text
const exCopyBtn = document.getElementById('ex_copy'); if (exCopyBtn) exCopyBtn.onclick = async function(){
  const txt = document.getElementById('ex_text').innerText.trim();
  try{
    await navigator.clipboard.writeText(txt);
    const btn = this;
    const old = btn.textContent;
    btn.textContent = 'Copied!';
    setTimeout(()=>btn.textContent = old, 1200);
  }catch(e){ alert('Copy failed'); }
};


// rain generator removed (replaced)


// --- Adjustment Rain (robust + categories) ---
document.addEventListener('DOMContentLoaded', function(){
  const rain = document.querySelector('.rain');
  if (!rain) return;
  const emojis = ['🧠','✍️','⏳','📋','🎧','✅','🧭','📚','🧩','🪄'];
  function rand(min,max){ return Math.random()*(max-min)+min; }
  const count = window.matchMedia('(max-width: 640px)').matches ? 14 : 26;

  for (let i=0;i<count;i++){
    const d = document.createElement('div');
    d.className = 'drop';
    const pick = tk[Math.floor(Math.random()*tk.length)];
    const useEmoji = Math.random() < 0.12 && pick.cat !== 'satire';
    const text = useEmoji ? emojis[Math.floor(Math.random()*emojis.length)] : pick.text;
    const cls = 'tag cat-' + pick.cat;
    d.innerHTML = `<span class="${cls}">${useEmoji ? `<span class="em">${text}</span>` : text}</span>`;
    d.style.left = rand(2, 96) + '%';
    const dur = rand(7, 11);
    const delay = rand(-10, 0);
    const scale = rand(0.9, 1.15);
    const sway = rand(8, 22); // px sideways sway
    d.style.animationDuration = dur + 's';
    d.style.animationDelay = delay + 's';
    d.style.setProperty('--sway', sway + 'px');
    d.style.transform = `translateY(-10%) scale(${scale})`;
    rain.appendChild(d);
  }
});


</script>
</body>
</html>